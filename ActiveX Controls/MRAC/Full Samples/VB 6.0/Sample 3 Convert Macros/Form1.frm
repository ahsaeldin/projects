VERSION 5.00
Object = "{F9043C88-F6F2-101A-A3C9-08002B2F49FB}#1.2#0"; "Comdlg32.ocx"
Object = "{42E02B6F-DBB2-11DA-AB1C-00E04C770EEB}#1.0#0"; "mrac.ocx"
Begin VB.Form Form1 
   Caption         =   "Vb Macro Recorder"
   ClientHeight    =   2865
   ClientLeft      =   60
   ClientTop       =   345
   ClientWidth     =   7395
   LinkTopic       =   "Form1"
   ScaleHeight     =   2865
   ScaleWidth      =   7395
   StartUpPosition =   2  'CenterScreen
   Begin MacroRecorderActX.MacroRecorder MacroRecorder1 
      Left            =   2520
      Top             =   240
      _ExtentX        =   926
      _ExtentY        =   926
   End
   Begin VB.Timer tmrState 
      Interval        =   100
      Left            =   2040
      Top             =   240
   End
   Begin MSComDlg.CommonDialog CommonDialog1 
      Left            =   1560
      Top             =   240
      _ExtentX        =   847
      _ExtentY        =   847
      _Version        =   393216
   End
   Begin VB.Frame Frame1 
      Height          =   2775
      Left            =   120
      TabIndex        =   0
      Top             =   0
      Width           =   7215
      Begin VB.CommandButton cmdConvert 
         Caption         =   "&Convert"
         Height          =   375
         Left            =   120
         TabIndex        =   3
         Top             =   1200
         Width           =   1215
      End
      Begin VB.CommandButton cmdStopRecord 
         Caption         =   "&Stop Record"
         Height          =   375
         Left            =   120
         TabIndex        =   2
         Top             =   720
         Width           =   1215
      End
      Begin VB.CommandButton cmdRecord 
         Caption         =   "&Record"
         Height          =   375
         Left            =   120
         TabIndex        =   1
         Top             =   240
         Width           =   1215
      End
      Begin VB.Label Label1 
         Caption         =   $"Form1.frx":0000
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   178
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   975
         Left            =   120
         TabIndex        =   4
         Top             =   1680
         Width           =   6975
      End
   End
End
Attribute VB_Name = "Form1"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'=============================================================================
'Publisher      CprinGold Software.
'               http://www.cpringold.com
'               support@cpringold.com
'
'
' Description:  A sample code demonstrates how to use MacroRecorder
'               ActiveX control v1.50 to convert normal macro file to
'               an executable macro file.
'=============================================================================
Option Explicit
 
Private Declare Function GetAsyncKeyState Lib "user32" (ByVal vKey As Long) As Integer

'==============================================================================
' Method:        cmdRecord_Click
'
' Description:  Start recording a new macro.
'==============================================================================
Private Sub cmdRecord_Click()
    If Me.WindowState <> 1 Then Me.WindowState = 1
    MacroRecorder1.Record
End Sub

'==============================================================================
' Method:        cmdStopRecord_Click
'
' Description:  Stop recording and save the macro to the disk.
'==============================================================================
Private Sub cmdStopRecord_Click()

  '  On Error GoTo quitme:

    'Only if State is recording.
    If Not MacroRecorder1.IsRecord Then
        Exit Sub
    End If

    Me.WindowState = 0

    'Stop recording while get the path from the user
    MacroRecorder1.StopRecord

    With CommonDialog1
        'You can use any extension for the macro file name, or you can use no extension.
        'hence it will be easy to integrate the MacroRecorder ActiveX Control in your
        'Applications by using any file extension you want for the macro file generated by
        'MacroRecorder ActiveX Control.
      
        .FileName = "macro1"
        .Flags = cdlOFNOverwritePrompt + cdlOFNPathMustExist
        .ShowSave
    End With

    'You can use any extension for the macro file name, or you can use no extension.
    'hence it will be easy to integrate the MacroRecorder ActiveX Control in your
    'Applications by using any file extension you want for the macro file generated by
    'MacroRecorder ActiveX Control.
    
    'For example suppose that you want to save the macro to c:\
    'If you want to assign (*.xxx) as an extension for the generated macro file,
    'then all you have to do is
    'MacroRecorder1.Save ("c:\mymacro.xxx")
    'If you want to use no extension then use the following:
    'MacroRecorder1.Save ("c:\mymacro")
    
     MacroRecorder1.Save (CommonDialog1.FileName)

End Sub

'==============================================================================
' Method:        cmdConvert_Click
'
' Description: convert normal macro file to an executable macro file.
'==============================================================================
Private Sub cmdConvert_Click()
    If Not MacroRecorder1.IsRecord And Not MacroRecorder1.IsReplay Then
        CommonDialog1.ShowOpen
        MacroRecorder1.ConvertToExE CommonDialog1.FileName, "c:\" & CommonDialog1.FileTitle
    End If
End Sub
Private Sub MacroRecorder1_ConvertComplete(ByVal MacFilePath As String)
    If MacFilePath <> "" Then MsgBox "Macro Converted and saved To " & MacFilePath
End Sub

Private Sub MacroRecorder1_RecordStart()
    MsgBox "Press Alt+F10 to Stop Recording."
End Sub

Private Sub tmrState_Timer()

    'Stop Recording when you Click Alt+F10
    If GetAsyncKeyState(vbKeyF10) And GetAsyncKeyState(18) Then
        cmdStopRecord_Click
    End If

   If MacroRecorder1.IsRecord And Not Me.Caption = "Recording ..." Then
        Me.Caption = "Recording ..."
    ElseIf Not MacroRecorder1.IsReplay And Not MacroRecorder1.IsRecord Then
        If Not Me.Caption = "Vb Macro Recorder" Then
            Me.Caption = "Vb Macro Recorder"
        End If
    End If

End Sub
